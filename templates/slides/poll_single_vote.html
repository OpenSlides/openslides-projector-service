<link rel="stylesheet" type="text/css" href="/system/projector/static/slide/poll_common.css" />
<link rel="stylesheet" type="text/css" href="/system/projector/static/slide/poll_single_vote.css" />

<div class="content full-height">
    <div class="single-votes-slidetitle">
        <h1>{{ .Title }}</h1>
        {{if .Subtitle}}
            <h2 class="poll-title">{{ .Subtitle }}</h2>
        {{end}}
    </div>

    <div class="poll-bar-wrapper">
        <div class="poll-bar">
            {{if .PollOption.Yes}}
                <div class="bg-yes" style="flex: {{.PollOption.Yes}} 0 auto"></div>
            {{end}}
            {{if .PollOption.No}}
                <div class="bg-no" style="flex: {{.PollOption.No}} 0 auto"></div>
            {{end}}
            {{if and .PollOption.Abstain (ne .Poll.OnehundredPercentBase "YN")}}
                <div class="bg-abstain" style="flex: {{.PollOption.Abstain}} 0 auto"></div>
            {{end}}
        </div>
        <div class="data-area">
            <div class="general-data">
                <div>
                    {{ .Loc.Get "Valid votes" }}: {{ .Poll.Votesvalid }}
                    {{if ne .Poll.OnehundredPercentBase "YN"}}
                        {-{ .Poll.votesvalid | pollPercentBase: polldata }-}
                    {{end}}
                </div>
                <div>
                    {{ .Loc.Get "Entitled users" }}: {{ .NumEntitledUsers }}
                    {{if eq .Poll.OnehundredPercentBase "entitled"}}
                        {-{ .Poll.entitled_users_at_stop.length | pollPercentBase: polldata }}
                    {{end}}
                </div>
            </div>
            {{if .PollMethod.Yes}}
                <os-icon-container icon="check_circle" iconClass="yes" size="large">
                    <span class="yes">
                        {{ .Loc.Get "Yes" }}: {{ .PollOption.Yes }}
                        {-{ .Poll.options[0]?.yes ?? 0 | pollPercentBase: polldata }}
                    </span>
                </os-icon-container>
            {{end}}
            {{if .PollMethod.No}}
                <os-icon-container icon="cancel" iconClass="no" size="large">
                    <span class="no">
                        {{ .Loc.Get "No" }}: {{ .PollOption.No }}
                        {-{ .Poll.options[0]?.no ?? 0 | pollPercentBase: polldata }}
                    </span>
                </os-icon-container>
            {{end}}
            {{if .PollMethod.Abstain}}
                <os-icon-container icon="circle" iconClass="abstain" size="large">
                    <span class="abstain">
                        {{ .Loc.Get "Abstain" }}: {{.PollOption.Abstain}}
                        {{if ne .Poll.OnehundredPercentBase "YN"}}
                            {-{ .Poll.options[0]?.abstain ?? 0 | pollPercentBase: polldata }}
                        {{end}}
                    </span>
                </os-icon-container>
            {{end}}
        </div>
    </div>

    <div class="content-wrapper">
        <div [ngStyle]="textDivStyles">
            <div class="poll-result-area">
                <div class="votes-area">
                    @for (column of userVotesFormatted; track column) {
                        <div class="votes-column" [ngStyle]="columnStyle">
                            @for (user of column; track user[0]) {
                                <div class="vote-entry">
                                    @if (user[1] === 'Y') {
                                        <os-icon-container icon="check_circle" iconClass="yes" [noWrap]="true">
                                            {-{ user[0] }}
                                        </os-icon-container>
                                    } @else if (user[1] === 'N') {
                                        <os-icon-container icon="cancel" iconClass="no" [noWrap]="true">
                                            {-{ user[0] }}
                                        </os-icon-container>
                                    } @else if (user[1] === 'A') {
                                        <os-icon-container icon="circle" iconClass="abstain" [noWrap]="true">
                                            {-{ user[0] }}
                                        </os-icon-container>
                                    } @else {
                                        <os-icon-container
                                            icon="radio_button_unchecked"
                                            iconClass="no-content"
                                            [noWrap]="true"
                                        >
                                            {-{ user[0] }}
                                        </os-icon-container>
                                    }
                                </div>
                            }
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>
